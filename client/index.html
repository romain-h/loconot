<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Loconot WebApp</title>
  <link rel="stylesheet" href="assets/stylesheets/main.css">
  <script type="text/javascript" data-main="/app/config"
  src="/vendor/js/require.js"></script>
  <script type="text/javascript"
    src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyDRr0gSw0CU
    MA2nr3lgNkWbow1jsFa2vFk&sensor=true">
  </script>
  <script type="text/javascript">
  var geocoder;
  function initialize() {
    google.maps.visualRefresh = true;
    geocoder = new google.maps.Geocoder();

    var mapOptions = {
      center: new google.maps.LatLng(48.881115099999995, 2.3448237),
      zoom: 16,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map-canvas"),
        mapOptions);

    geocoder.geocode( { 'address': '3 rue baliat Courbevoie'}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
        console.log(marker);
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });

    // Add new marker
    google.maps.event.addListener(map, "rightclick", function(event) {
        var lat = event.latLng.lat();
        var lng = event.latLng.lng();
        // populate yor box/field with lat, lng
        console.log("Lat=" + lat + "; Lng=" + lng);
        var marker = new google.maps.Marker({
            map: map,
            position: event.latLng
        });
        // Add infos
        var infoWin = new google.maps.InfoWindow({
          content: "This marker's position is: <b>" + "<br />" + "Latitude: " + event.latLng.lat().toString() + "<br />" + "Longitude: " + event.latLng.lng().toString()+"</b><br/><a href='javascript:map.removeOverlay(lastMarker);'>remove</a>"
        });
            // Edit new marker
      google.maps.event.addListener(marker, "click", function() {
        infoWin.open(marker.get('map'), marker);
      });
        map.setCenter(event.latLng);
    });



  }
  google.maps.event.addDomListener(window, 'load', initialize);

  var search = function(){
    var addressField = document.getElementById('search_address');
    geocoder.geocode( { 'address': addressField.value}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
        console.log(marker);
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });
  }


  //       var lastMarker;
  //       var newLocation;
  //       var map;
  // function load() {
  //       if (GBrowserIsCompatible()) {
  //           map = new GMap2(document.getElementById("map"));
  //           map.addControl(new GSmallMapControl());
  //           map.addControl(new GMapTypeControl());
  //           map.setCenter(new GLatLng(37.4, -122.1), 13);

  //   // This deletes the marker when clicked on if it is a temporary marker
  //   GEvent.addListener(map, "click", function(marker,point) {
  //   if (marker && marker.openInfoWindowHtml) {
  //               lastMarker = marker;
  //               marker.openInfoWindowHtml("This marker's position is: <b>" + "<br />" + "Latitude: " + marker.getPoint().lat().toString() + "<br />" + "Longitude: " + marker.getPoint().lng().toString()+"</b><br/><a href='javascript:map.removeOverlay(lastMarker);'>remove</a>");
  //   } else if (point) {
  //         newLocation = new GMarker(point);
  //   map.addOverlay(newLocation);
  //               newLocation.openInfoWindowHtml("This marker's position is: <b>" + "<br />" + "Latitude: " + point.lat().toString() + "<br />" + "Longitude: " + point.lng().toString()+"</b><br/><a href='javascript:map.removeOverlay(newLocation);'>remove</a>");
  //               }
  //     });
  //       }
  // }

  </script>
</head>
<body>

  <div class="row">
    <div class="col-lg-8">
      <div id="map-canvas"></div>
    </div>
    <div class="col-lg-4">
      <h1>Loconot WebApp</h1>
      <span class="glyphicon glyphicon-ok-circle"></span>
      <div id="mainApp">
        <ul id="loconotsList" class="list-group loconotsList"></ul>
        <button id="addLoconotBtn" type="button" class="btn btn-success">
          <span class="glyphicon glyphicon-map-marker"></span> Add new
        </button>
        <input type="text" id="search_address" value=""/>
        <button onclick="search();">Search</button>
      </div>
    </div>
  </div>

</body>
</html>